# Project Multilevel Index - CLI Tool

**Standalone CLI tool for fractal multi-level index system**

A command-line tool that automatically maintains project documentation through fractal self-referential indexes.

## Features

- ğŸ” **Multi-language code analysis** - Supports 10+ programming languages
- ğŸ“ **Auto-generated file headers** - Input/Output/Position comments
- ğŸ“ **Folder indexes** - FOLDER_INDEX.md for each directory
- ğŸ“Š **Project index** - PROJECT_INDEX.md with dependency graph
- ğŸ”„ **Self-referential** - Documents that maintain themselves

## Installation

### From npm (coming soon)

```bash
npm install -g @project-multilevel-index/cli
```

### From source (current)

```bash
git clone https://github.com/Claudate/project-multilevel-index.git
cd project-multilevel-index/cli
npm install
npm run build
npm link
```

After linking, you can use `codex` command globally.

## Usage

### Initialize index system

```bash
# In your project directory
codex init

# Or specify a path
codex init --path /path/to/project

# With custom options
codex init --max-depth 5 --max-nodes 30 --exclude "**/*.test.ts"
```

### Options

```
-p, --path <path>              Project root path (default: current directory)
-e, --exclude <patterns...>    Additional exclude patterns
--max-depth <number>           Maximum directory depth (default: 10)
--max-nodes <number>           Maximum nodes in dependency graph (default: 50)
```

### What it does

1. **Scans** your project for code files
2. **Analyzes** dependencies and exports
3. **Generates** file header comments with Input/Output/Pos
4. **Creates** FOLDER_INDEX.md in each directory
5. **Builds** PROJECT_INDEX.md with dependency graph

## Supported Languages

| Language | Extensions | Analysis Method |
|----------|------------|----------------|
| JavaScript/TypeScript | `.js`, `.ts`, `.jsx`, `.tsx`, `.mjs`, `.cjs` | AST (Babel) + Regex |
| Python | `.py` | Regex |
| Java/Kotlin | `.java`, `.kt` | Regex |
| Rust | `.rs` | Regex |
| Go | `.go` | Regex |
| C/C++ | `.c`, `.cpp`, `.h`, `.hpp` | Regex |
| C# | `.cs` | Regex |
| PHP | `.php` | Regex |
| Ruby | `.rb` | Regex |
| Swift | `.swift` | Regex |

## Example Output

### File Header (TypeScript)

```typescript
/**
 * Input: express, ../models/User, ../services/authService
 * Output: router, POST /login, GET /profile
 * Pos: API Layer - HTTP request handler
 *
 * ğŸ”„ Self-reference: When this file changes, update this header
 */

import express from 'express';
import { User } from '../models/User';
// ...
```

### FOLDER_INDEX.md

```markdown
## ğŸ“ services/

**Architecture**:
- Business logic layer

**Files**:
- `userService.ts` - Exports UserService and 2 more
- `authService.ts` - Exports AuthService

ğŸ”„ **Self-reference**: When files in this folder change, update this index and PROJECT_INDEX.md
```

### PROJECT_INDEX.md

```markdown
# my-project - Project Index

## ğŸ“– Project Overview

Auto-generated project index maintained by the Fractal Multi-level Index System.

## ğŸ“ Directory Structure

\`\`\`
  â”œâ”€â”€ controllers/ (3 files)
  â”œâ”€â”€ services/ (2 files)
  â”œâ”€â”€ models/ (2 files)
  â”œâ”€â”€ utils/ (1 files)
\`\`\`

## ğŸ”— Dependency Graph

\`\`\`mermaid
graph TD
  userController[userController]
  userService[userService]
  User[User]
  userController --> userService
  userService --> User
\`\`\`

## ğŸ“Š Statistics

- Total folders: 4
- Total files: 8

---

ğŸ”„ **Self-reference**: When project structure changes, update this index

ğŸ¼ Generated by [Project Multilevel Index](https://github.com/Claudate/project-multilevel-index)
```

## How It Works

1. **File Scanner** - Uses `glob` to find code files, respects `.gitignore`
2. **Analyzer** - Parses code with Babel (JS/TS) or regex (other languages)
3. **Generator** - Creates headers and indexes based on analysis
4. **Updater** - Writes files to disk with proper formatting

## Architecture

```
cli/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ analyzer.ts      # Multi-language code analysis
â”‚   â”‚   â””â”€â”€ generator.ts     # Header and index generation
â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â””â”€â”€ init.ts          # Init command implementation
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ file-scanner.ts  # File system scanning
â”‚   â””â”€â”€ cli.ts               # CLI entry point
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

## Development

```bash
# Install dependencies
npm install

# Build
npm run build

# Watch mode
npm run watch

# Run locally
npm run dev init --path /path/to/project

# Test
npm test
```

## Comparison with VSCode Extension

| Feature | CLI Tool | VSCode Extension |
|---------|----------|------------------|
| **Platform** | Any terminal | VSCode/Cursor/Windsurf |
| **Automation** | Manual command | Auto on file save |
| **Use case** | CI/CD, one-time setup | Real-time development |
| **Installation** | npm/yarn | VSCode Marketplace |

## Roadmap

- [x] Init command with file scanning
- [x] Multi-language analysis
- [x] Header and index generation
- [ ] Update command (incremental)
- [ ] Check command (consistency validation)
- [ ] Configuration file support
- [ ] Watch mode (auto-update on file changes)
- [ ] npm package publication

## Related

- **Claude Code Plugin**: Full automation through hook system
- **VSCode Extension**: Auto-update on file save (coming soon)
- **Universal Core**: Shared logic across platforms

## License

MIT

## Links

- [GitHub Repository](https://github.com/Claudate/project-multilevel-index)
- [Main README](../README.md)
- [VSCode Extension Plan](../VSCODE_EXTENSION_PLAN.md)
